<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üß† Assistant IA M√©dicale Autonome ‚Äì Mode Offline</title>
  <style>
    body { font-family: system-ui, sans-serif; max-width: 800px; margin: 2rem auto; padding: 1rem; background: #f8f9fa; color: #212529; }
    h1 { text-align: center; color: #0d6efd; }
    .disclaimer { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem; margin: 1.5rem 0; border-radius: 4px; font-size: 0.95rem; }
    #chatBox { border: 1px solid #dee2e6; border-radius: 8px; height: 60vh; overflow-y: auto; padding: 1rem; background: white; margin-bottom: 1rem; display: flex; flex-direction: column; gap: 1rem; }
    .message { max-width: 80%; padding: 0.8rem 1rem; border-radius: 18px; line-height: 1.5; }
    .user { align-self: flex-end; background: #0d6efd; color: white; border-bottom-right-radius: 4px; }
    .bot { align-self: flex-start; background: #e9ecef; color: #212529; border-bottom-left-radius: 4px; }
    #inputArea { display: flex; gap: 0.5rem; }
    #userInput { flex: 1; padding: 0.8rem; border: 1px solid #ced4da; border-radius: 8px; font-size: 1rem; }
    #sendBtn { padding: 0 1.5rem; background: #0d6efd; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; }
    #sendBtn:hover { background: #0b5ed7; }
    footer { text-align: center; margin-top: 2rem; color: #6c757d; font-size: 0.9rem; }
  </style>
</head>
<body>

  <h1>üß† Assistant IA M√©dicale Autonome<br><small>Mode Offline & √âducatif ‚Äì NetSecurePro</small></h1>

  <div class="disclaimer">
    <strong>‚ö†Ô∏è Important :</strong> Cet assistant est strictement informatif et √©ducatif. Il ne remplace en aucun cas un m√©decin. 
    Il ne pose pas de diagnostic, ne prescrit pas de traitement et ne donne pas de conseil m√©dical personnalis√©. 
    Consultez toujours un professionnel de sant√© pour toute question concernant votre sant√©.
  </div>

  <div id="chatBox"></div>

  <div id="inputArea">
    <input type="text" id="userInput" placeholder="Posez une question g√©n√©rale sur un marqueur biologique, une valeur de labo, etc." autocomplete="off">
    <button id="sendBtn">Envoyer</button>
  </div>

  <footer>
    Version offline s√©curis√©e | Aucune donn√©e transmise | D√©cembre 2025
  </footer>

  <script>
    // Prompt syst√®me concis (version valid√©e)
    const SYSTEM_PROMPT = `Tu es un Assistant M√©dical Informatif Autonome (ü§ñ IA M√©dicale Autonome - NetSecurePro). Ton r√¥le est strictement √©ducatif.

R√àGLES STRICTES :
- Tu ne poses JAMAIS de diagnostic.
- Tu ne prescris JAMAIS de traitement ni m√©dicament.
- Tu ne donnes JAMAIS de conseil m√©dical personnalis√©.
- Toute r√©ponse doit rappeler que tu n‚Äôes pas un m√©decin et que l‚Äôutilisateur doit consulter un professionnel de sant√©.
- Tu t‚Äôappuies uniquement sur des connaissances m√©dicales g√©n√©rales valid√©es (recommandations HAS, ADA, ESC, WHO, etc.).
- Tu ne cites JAMAIS de r√©f√©rences PMID pr√©cises ou d‚Äôarticles r√©cents non v√©rifi√©s. Utilise seulement des sources g√©n√©rales (ex : ¬´ selon les recommandations ADA 2025 ¬ª).

STYLE DE R√âPONSE :
- Fran√ßais clair, empathique et accessible.
- Structure simple :
  ‚Ä¢ Explication du concept ou de la valeur biologique
  ‚Ä¢ Interpr√©tation g√©n√©rale (fourchettes, significations courantes)
  ‚Ä¢ Limites de l‚Äôinterpr√©tation
  ‚Ä¢ Insistance sur la consultation m√©dicale
- Utilise des listes √† puces si utile.
- Termine toujours par : "‚ö†Ô∏è Consultez un m√©decin pour une √©valuation compl√®te."

Commence chaque r√©ponse par : <strong>ü§ñ IA M√©dicale Autonome :</strong><br><br>

Refuse poliment toute demande de diagnostic, interpr√©tation d‚Äôimage m√©dicale ou conseil th√©rapeutique.`;

    // Simulation tr√®s basique d'un LLM local (remplace ceci par Ollama/LM Studio en vrai projet)
    // Ici, on utilise un moteur de r√®gles simple bas√© sur mots-cl√©s pour rester 100% offline l√©ger
    const responses = {
      // CRP
      "crp": `ü§ñ IA M√©dicale Autonome :<br><br>
La CRP (Prot√©ine C R√©active) est un marqueur biologique de l'inflammation.<br><br>
‚Ä¢ Valeurs normales : g√©n√©ralement < 5-10 mg/L (selon les laboratoires).<br>
‚Ä¢ √âl√©vation mod√©r√©e (10-50 mg/L) : souvent infection virale ou inflammation l√©g√®re.<br>
‚Ä¢ √âl√©vation importante (> 50-100 mg/L) : peut √©voquer une infection bact√©rienne ou une inflammation plus s√©v√®re.<br><br>
Ces seuils sont indicatifs et varient selon le contexte (√¢ge, comorbidit√©s, etc.). De nombreux facteurs non infectieux peuvent aussi l'augmenter (traumatisme, maladie auto-immune, etc.).<br><br>
‚ö†Ô∏è Consultez un m√©decin pour une √©valuation compl√®te.`,

      // Glyc√©mie
      "glyc√©mie|diab√®te|sucre": `ü§ñ IA M√©dicale Autonome :<br><br>
La glyc√©mie √† jeun permet d'√©valuer le m√©tabolisme du glucose.<br><br>
‚Ä¢ Normale : < 1,10 g/L (ou < 6,1 mmol/L).<br>
‚Ä¢ Prediab√®te : 1,10‚Äì1,25 g/L.<br>
‚Ä¢ Diab√®te (selon recommandations ADA 2025) : ‚â• 1,26 g/L √† deux reprises.<br><br>
L'HbA1c compl√®te l'√©valuation (diab√®te si ‚â• 6,5 %).<br><br>
Une valeur isol√©e ne suffit pas pour poser un diagnostic : r√©p√©tition, contexte et autres examens sont n√©cessaires.<br><br>
‚ö†Ô∏è Consultez un m√©decin pour une √©valuation compl√®te.`,

      // TSH
      "tsh|thyro√Øde": `ü§ñ IA M√©dicale Autonome :<br><br>
La TSH est l'hormone qui r√©gule la thyro√Øde.<br><br>
‚Ä¢ Valeurs normales : g√©n√©ralement 0,4‚Äì4,0 mUI/L (varie selon labo et √¢ge).<br>
‚Ä¢ TSH √©lev√©e : peut sugg√©rer une hypothyro√Ødie.<br>
‚Ä¢ TSH basse : peut √©voquer une hyperthyro√Ødie.<br><br>
L'interpr√©tation n√©cessite toujours le dosage des hormones thyro√Ødiennes libres (T4L, T3L) et le contexte clinique.<br><br>
‚ö†Ô∏è Consultez un m√©decin pour une √©valuation compl√®te.`,

      // D√©faut
      "default": `ü§ñ IA M√©dicale Autonome :<br><br>
Je suis un assistant √©ducatif limit√© √† des informations m√©dicales g√©n√©rales.<br><br>
Votre question semble porter sur un cas sp√©cifique ou demande une interpr√©tation personnalis√©e, ce que je ne peux pas faire.<br><br>
Je vous invite √† reformuler en posant une question g√©n√©rale sur un marqueur biologique ou une notion m√©dicale (ex : "Que signifie une CRP √©lev√©e ?").<br><br>
‚ö†Ô∏è Consultez un m√©decin pour une √©valuation compl√®te.`
    };

    function getResponse(userInput) {
      const lower = userInput.toLowerCase();
      if (lower.includes("crp")) return responses["crp"];
      if (lower.match(/glyc√©mie|diab√®te|sucre/)) return responses["glyc√©mie|diab√®te|sucre"];
      if (lower.match(/tsh|thyro√Øde/)) return responses["tsh|thyro√Øde"];
      return responses["default"];
    }

    function addMessage(text, sender) {
      const chatBox = document.getElementById("chatBox");
      const msgDiv = document.createElement("div");
      msgDiv.className = `message ${sender}`;
      msgDiv.innerHTML = text.replace(/\n/g, "<br>");
      chatBox.appendChild(msgDiv);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    document.getElementById("sendBtn").addEventListener("click", sendMessage);
    document.getElementById("userInput").addEventListener("keypress", e => {
      if (e.key === "Enter") sendMessage();
    });

    function sendMessage() {
      const input = document.getElementById("userInput");
      const text = input.value.trim();
      if (!text) return;

      addMessage(text, "user");
      input.value = "";

      // Simulation r√©ponse (en vrai : appel √† mod√®le local)
      setTimeout(() => {
        const botResponse = getResponse(text);
        addMessage(botResponse, "bot");
      }, 600);
    }

    // Message d'accueil
    window.onload = () => {
      addMessage(`<strong>ü§ñ IA M√©dicale Autonome :</strong><br><br>
Bonjour ! Je suis un assistant √©ducatif offline.<br><br>
Je peux vous expliquer de fa√ßon g√©n√©rale la signification de marqueurs biologiques courants (CRP, glyc√©mie, TSH, etc.).<br><br>
Je ne pose jamais de diagnostic ni ne donne de conseil personnalis√©.<br><br>
‚ö†Ô∏è Consultez un m√©decin pour une √©valuation compl√®te.`, "bot");
    };
  </script>
</body>
</html>
